<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arkiv Event Tickets - Seat Selection</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1><i class="fas fa-ticket-alt"></i> Arkiv Event Tickets</h1>
            <div class="event-info" id="event-info">
                <h2>Loading event...</h2>
                <p>Please wait while we load the event details.</p>
            </div>
        </header>

        <main class="main-content">
            <!-- Legend -->
            <div class="legend">
                <h3><i class="fas fa-info-circle"></i> Seat Legend</h3>
                <div class="legend-items">
                    <div class="legend-item">
                        <div class="seat-demo available"></div>
                        <span>Available</span>
                    </div>
                    <div class="legend-item">
                        <div class="seat-demo selected"></div>
                        <span>Selected</span>
                    </div>
                    <div class="legend-item">
                        <div class="seat-demo reserved"></div>
                        <span>Reserved</span>
                    </div>
                    <div class="legend-item">
                        <div class="seat-demo sold"></div>
                        <span>Sold</span>
                    </div>
                </div>
            </div>

            <!-- Price Categories -->
            <div class="price-info">
                <h3><i class="fas fa-tags"></i> Pricing</h3>
                <div class="price-categories" id="price-categories">
                    <!-- Will be populated by JavaScript -->
                </div>
            </div>

            <!-- Seat Map -->
            <div class="seat-map-container">
                <div class="stage">
                    <i class="fas fa-theater-masks"></i>
                    <span>STAGE</span>
                </div>
                
                <div class="seat-map" id="seat-map">
                    <!-- Seats will be dynamically generated -->
                    <div class="loading">
                        <i class="fas fa-spinner fa-spin"></i>
                        <p>Loading seat map...</p>
                    </div>
                </div>
                
                <div class="screen-indicator">
                    <span>← Screen/Stage →</span>
                </div>
            </div>

            <!-- Selection Summary -->
            <div class="selection-summary" id="selection-summary" style="display: none;">
                <h3><i class="fas fa-shopping-cart"></i> Your Selection</h3>
                <div class="selected-seats" id="selected-seats">
                    <!-- Selected seats will appear here -->
                </div>
                <div class="total-price">
                    Total: $<span id="total-price">0</span>
                </div>
                <div class="action-buttons">
                    <button class="btn btn-secondary" onclick="clearSelection()">
                        <i class="fas fa-times"></i> Clear Selection
                    </button>
                    <button class="btn btn-primary" onclick="proceedToCheckout()">
                        <i class="fas fa-arrow-right"></i> Proceed to Checkout
                    </button>
                </div>
            </div>
        </main>

        <!-- Purchase Modal -->
        <div class="modal" id="purchase-modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-credit-card"></i> Complete Your Purchase</h3>
                    <button class="close-modal" onclick="closePurchaseModal()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="modal-body">
                    <div class="purchase-summary">
                        <h4>Order Summary</h4>
                        <div id="purchase-seats"></div>
                        <div class="purchase-total">
                            Total: $<span id="purchase-total">0</span>
                        </div>
                    </div>

                    <form id="purchase-form" class="purchase-form">
                        <h4>Customer Information</h4>
                        <div class="form-group">
                            <label for="customer-name">Full Name *</label>
                            <input type="text" id="customer-name" name="name" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="customer-email">Email Address *</label>
                            <input type="email" id="customer-email" name="email" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="customer-phone">Phone Number</label>
                            <input type="tel" id="customer-phone" name="phone">
                        </div>

                        <h4>Payment Information</h4>
                        <div class="form-group">
                            <label for="card-number">Card Number *</label>
                            <input type="text" id="card-number" name="cardNumber" placeholder="1234 5678 9012 3456" required>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label for="expiry">Expiry Date *</label>
                                <input type="text" id="expiry" name="expiry" placeholder="MM/YY" required>
                            </div>
                            <div class="form-group">
                                <label for="cvv">CVV *</label>
                                <input type="text" id="cvv" name="cvv" placeholder="123" required>
                            </div>
                        </div>

                        <div class="form-actions">
                            <button type="button" class="btn btn-secondary" onclick="closePurchaseModal()">
                                Cancel
                            </button>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-lock"></i> Complete Purchase
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- Success Modal -->
        <div class="modal" id="success-modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3><i class="fas fa-check-circle" style="color: green;"></i> Purchase Successful!</h3>
                </div>
                
                <div class="modal-body">
                    <div class="success-message">
                        <p>Your tickets have been successfully purchased and recorded on the Arkiv blockchain!</p>
                        <div class="ticket-info">
                            <p><strong>Ticket ID:</strong> <span id="ticket-id"></span></p>
                            <p><strong>Transaction ID:</strong> <span id="transaction-id"></span></p>
                        </div>
                        <p class="confirmation-note">
                            A confirmation email has been sent to your email address with your ticket details and QR code.
                        </p>
                    </div>
                    
                    <div class="success-actions">
                        <button class="btn btn-primary" onclick="downloadTicket()">
                            <i class="fas fa-download"></i> Download Ticket
                        </button>
                        <button class="btn btn-secondary" onclick="resetBooking()">
                            <i class="fas fa-home"></i> Book More Tickets
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Loading overlay -->
    <div class="loading-overlay" id="loading-overlay" style="display: none;">
        <div class="loading-spinner">
            <i class="fas fa-spinner fa-spin fa-3x"></i>
            <p>Processing your request...</p>
        </div>
    </div>

    <script type="module" src="mock-data.js"></script>
    <script type="module" src="script.js"></script>
    <script type="module" src="seat-map.js"></script>
</body>
</html>